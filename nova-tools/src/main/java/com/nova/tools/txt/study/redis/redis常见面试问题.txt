一.redis数据结构


二.缓存雪崩和穿透
1.缓存雪崩：大量缓存数据同时间失效，导致用户直接发起大量请求到数据库，产生瓶颈。
（1）生成随机失效的缓存时间数据；
（2）让缓存节点分布在不同的物理节点上（redis的高可用，多台redis服务器集群）
（3）生成不失效的缓存数据；
（4）定时任务更新缓存数据；

2.缓存穿透：用户请求数据，例如ID为负数，不存在缓存里，也不存在数据库里，会造成缓存穿透。
（1）无意义数据放入缓存，下一次相同请求就会命中缓存；
（2）IP过滤；
（3）参数校验（权限校验，id基础校验>0,）；
（4）布隆过滤器；

3.缓存失效(缓存击穿)：热点key失效
（1）用久缓存；
（2）分布式锁
 a.单体应用—互斥锁—zookeeper ,redis分布式锁。

三.redis加锁
1.redis加锁
redis.setNx(); 1代表设置了锁，0代表了存在了锁（不做修改）